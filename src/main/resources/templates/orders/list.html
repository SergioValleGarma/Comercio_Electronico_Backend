<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mis Ã“rdenes</title>
    <link rel="stylesheet" href="/css/navbar.css">
    <link rel="stylesheet" href="/css/order-styles.css">
</head>
<body>
<div th:replace="~{fragments/navbar :: navbar}"></div>
<div class="container">
    <h1>ğŸ“‹ Mis Ã“rdenes</h1>

    <!-- Mensajes de Ã©xito/error -->
    <div th:if="${success}" class="alert alert-success">
        <p th:text="${success}"></p>
    </div>
    <div th:if="${error}" class="alert alert-error">
        <p th:text="${error}"></p>
    </div>

    <!-- EstadÃ­sticas del usuario -->
    <div class="stats">
        <p>ğŸ“Š <strong>Total de Ã³rdenes:</strong> <span th:text="${totalUserOrders}"></span></p>
        <p>ğŸ’° <strong>Total gastado:</strong> $<span th:text="${#numbers.formatDecimal(totalSpent, 1, 2)}"></span></p>
    </div>

    <!-- Verificar si hay Ã³rdenes -->
    <div th:if="${#lists.isEmpty(orders)}" class="empty-orders">
        <h2>ğŸ“¦ No tienes Ã³rdenes aÃºn</h2>
        <p>Â¡Explora nuestros productos y haz tu primera compra!</p>
        <a href="/products" class="btn btn-primary">ğŸ›ï¸ Explorar Productos</a>
    </div>

    <!-- Lista de Ã³rdenes -->
    <div th:if="${!#lists.isEmpty(orders)}">
        <table>
            <thead>
            <tr>
                <th>ğŸ”– Orden #</th>
                <th>ğŸ“… Fecha</th>
                <!--<th>ğŸ“ Estado</th> -->
                <th>ğŸ’° Total</th>
                <th>ğŸ“¦ Items</th>
                <th>âš™ï¸ Acciones</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="order : ${orders}">
                <td>
                    <strong th:text="${order.id}"></strong>
                </td>
                <td th:text="${#temporals.format(order.orderDate, 'dd/MM/yyyy HH:mm')}"></td>
                <!--<td>
                    <span class="status" th:classappend="'status-' + ${order.status.name().toLowerCase()}"
                          th:text="${order.status.displayName}"></span>
                </td>-->
                <td>
                    <strong th:text="'$' + ${#numbers.formatDecimal(order.totalAmount, 1, 2)}"></strong>
                </td>
                <td th:text="${#lists.size(order.orderItems)} + ' productos'"></td>
                <td>
                    <a th:href="@{/orders/{id}(id=${order.id})}" class="btn btn-primary btn-small">ğŸ‘ï¸ Ver Detalle</a>
                </td>
            </tr>
            </tbody>
        </table>

        <!-- PaginaciÃ³n -->
        <div class="pagination" th:if="${totalPages > 1}">
            <p>PÃ¡gina <strong th:text="${currentPage + 1}"></strong> de <strong th:text="${totalPages}"></strong></p>

            <a th:if="${hasPrevious}" th:href="@{/orders(page=${currentPage - 1})}" class="btn btn-primary">â¬…ï¸ Anterior</a>
            <a th:if="${hasNext}" th:href="@{/orders(page=${currentPage + 1})}" class="btn btn-primary">Siguiente â¡ï¸</a>
        </div>
    </div>

    <div class="navigation">
        <a href="/products" class="btn btn-primary">ğŸ›ï¸ Continuar Comprando</a>
        <a href="/cart" class="btn btn-primary">ğŸ›’ Ver Carrito</a>
    </div>
</div>

<script src="/js/order-scripts.js"></script>
</body>
</html>